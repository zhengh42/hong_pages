<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Strandness in RNASeq - LittleBitofData</title>
    <meta property="og:title" content="Strandness in RNASeq - LittleBitofData">
    

    
      
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="en">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.jpg" alt="Hong Zheng" /></a></h1>



      <nav class="menu">
        <input id="menu-check" type="checkbox" />
        <label id="menu-label" for="menu-check" class="unselectable">
          <span class="icon close-icon">✕</span>
          <span class="icon open-icon">☰</span>
          <span class="text">Menu</span>
        </label>
        <ul>
        
        
        <li><a href="/">Home</a></li>
        
        <li><a href="/en/about/">About</a></li>
        
        <li><a href="/en/">Blog</a></li>
        
        <li><a href="/en/vitae/">Vitae</a></li>
        
        <li><a href="/tags/">Tags 标签</a></li>
        
        <li><a href="/categories/">Categories 分类</a></li>
        
        <li><a href="/cn/">中文</a></li>
        
        

<li class="meu-extra"></li>



<li><a href="https://github.com/zhengh42/hong_pages/tree/master/content/en/2017-08-17-rnaseq-strandness.md" target="_blank">Edit this page</a></li>


<li><a href="/en/index.xml" type="application/rss+xml" title="RSS feed">Subscribe</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">License</a></li>


        </ul>
      </nav>
    </header>

    <article class="main">
      <header class="title">
      
<h1>Strandness in RNASeq</h1>


<h3>Hong Zheng / 
2017-08-17</h3>

<hr>


      </header>



<p>How to tell whether the paired-end sequencing reads in an RNASeq library are strand-specific or not? According to how read 1 and read 2 align to DNA and RNA sequences, there are three types of RNASeq libraries:</p>

<p><img src="https://github.com/zhengh42/myfiles/blob/master/research/RNASeq_strandness.png?raw=true" width="480" height="280" /></p>

<ul>
<li>If sequences of read 1 align to the RNA strand, the library is &ldquo;stranded&rdquo;.</li>
<li>If sequences of read 2 align to the RNA strand, the library is &ldquo;reversed stranded&rdquo;.</li>
<li>Sometimes sequences of read 1 align to the RNA strand; the other times sequences of read 2 align to the RNA strand. The library is &ldquo;unstranded&rdquo;.</li>
</ul>

<p>Different tools have different names for stranded setting. To name a few:</p>

<table>
<thead>
<tr>
<th></th>
<th>Case A</th>
<th>Case B</th>
<th>Case C</th>
</tr>
</thead>

<tbody>
<tr>
<td>METHODS<br> or KITS</td>
<td>Ligation<br>Standard SOLiD</td>
<td>dUTP<br> IlluminaTruSeq Stranded</td>
<td>Standard Illumina</td>
</tr>

<tr>
<td>TopHat</td>
<td>&ndash;library-type<br>fr-secondstrand</td>
<td>&ndash;library-type<br>fr-firststrand</td>
<td>&ndash;library-type<br>fr-unstranded</td>
</tr>

<tr>
<td>HTSeq</td>
<td>stranded=yes</td>
<td>stranded=reverse</td>
<td>stranded=no</td>
</tr>

<tr>
<td>FeatureCounts</td>
<td>-s 1</td>
<td>-s 2</td>
<td>-s 0</td>
</tr>

<tr>
<td>RSEM</td>
<td>&ndash;forward-prob 1</td>
<td>&ndash;forward-prob 0</td>
<td>&ndash;forward-prob 0.5</td>
</tr>

<tr>
<td>Kallisto</td>
<td>&ndash;fr-stranded</td>
<td>&ndash;rf-stranded</td>
<td></td>
</tr>

<tr>
<td>Salmon</td>
<td>-l ISF</td>
<td>-l ISR</td>
<td>-l IU</td>
</tr>

<tr>
<td>collectRnaSeq<br>Metrics</td>
<td>FIRST_READ_<br>TRANSCRIPTION_<br>STRAND</td>
<td>SECOND_READ_<br>TRANSCRIPTION_<br>STRAND</td>
<td></td>
</tr>

<tr>
<td>Trinity</td>
<td>&ndash;SS_lib_type FR</td>
<td>&ndash;SS_lib_type RF</td>
<td></td>
</tr>
</tbody>
</table>

<p>More information regarding RNA-Seq analysis pipelines and the parameter settings for the tools can be found:</p>

<p><a href="https://github.com/zhengh42/RNASeq_pipeline" target="_blank">GitHub: RNASeq pipelines</a></p>

<p><a href="https://academic.oup.com/gigascience/article/8/12/giz145/5663671?guestAccessKey=c350886b-32ec-416a-b941-a5cf68840cb8" target="_blank">GigaScience: Benchmark of RNA-Seq pipelines</a></p>

<hr />

<p>What is the most convenient way to tell the strandness? Usually I take about 50 thousands reads from both read 1 and read 2, naming it as test_1.fg.gz and test_2.fq.gz, and run one of the following tools:</p>

<ul>
<li><a href="https://github.com/alexdobin/STAR" target="_blank">STAR</a></li>
</ul>

<pre><code>STAR --genomeDir &lt;reference index directory&gt; --runThreadN &lt;assigned threads&gt; \
      --readFilesIn test_1.fq.gz test_2.fq.gz --readFilesCommand zcat \
      --outFileNamePrefix &lt;out dir and prefix&gt; --outSAMtype BAM  SortedByCoordinate \
      --twopassMode Basic --sjdbOverhang &lt;readlength - 1 &gt; \
      --quantMode TranscriptomeSAM GeneCounts \
      --outSAMunmapped Within  --outFilterType BySJout  --outSAMattributes NH HI AS NM MD
</code></pre>

<p>The <code>--quantMode GeneCounts</code> option will output a file with suffix &ldquo;ReadsPerGene.out.tab&rdquo;, which counts the number of reads mapping to each gene. For example:</p>

<pre><code>ENSG00000198804.2       555285  290702  281079
ENSG00000198938.2       471151  238612  232541
ENSG00000198886.2       466966  236203  230767
ENSG00000210082.2       404889  203289  201602
ENSG00000198712.1       359278  175022  184256
ENSG00000198727.2       297601  150393  147574
ENSG00000198763.3       288383  149779  138612
ENSG00000156508.17      189858  96202   93663
</code></pre>

<p>2rd column: counts for unstranded RNASeq (condition C)<br />
3rd column: counts for the stranded RNASeq (condition A)<br />
4rd column: counts for the reverse stranded RNASeq (condition B)</p>

<p>In the case above, the library is unstranded. If 4rd column counts are almost zero, the library is stranded, and vice versa.</p>

<ul>
<li><a href="https://github.com/pachterlab/kallisto" target="_blank">Kallisto</a></li>
</ul>

<p>I use the following script to get the strand information. The reads were processed with Kallisto under three library type settings. The output of the three settings were compared and the the library type can be found in the &ldquo;test.libtype&rdquo; file.</p>

<pre><code>kallisto quant -i ${KALLISTO_INDEX} -o ${OUT_DIR}/test.un ${SEQ_DIR}/test_1.fg.gz ${SEQ_DIR}/test_2.fq.gz
kallisto quant -i ${KALLISTO_INDEX} -o ${OUT_DIR}/test.rf ${SEQ_DIR}/test_1.fg.gz ${SEQ_DIR}/test_2.fq.gz --rf-stranded
kallisto quant -i ${KALLISTO_INDEX} -o ${OUT_DIR}/test.fr ${SEQ_DIR}/test_1.fg.gz ${SEQ_DIR}/test_2.fq.gz --fr-stranded

paste ${OUT_DIR}/test.fr/abundance.tsv ${OUT_DIR}/test.rf/abundance.tsv ${OUT_DIR}/test.un/abundance.tsv | cut -f1,4,9,14  | awk 'BEGIN{sum1=0;sum2=0;sun3=0}{sum1+=$2;sum2+=$3;sum3+=$4}END{print sum1,sum2,sum3}' &gt; ${OUT_DIR}/test.libtypetesting
less ${OUT_DIR}/test.libtypetesting | awk '{print $2/$1,$3/$1,$3/$2}' | awk '{if($1&lt;0.3 &amp;&amp; $3&gt;3)print &quot;stranded&quot;;else if($1&gt;3 &amp;&amp; $2&gt;3)print &quot;reverse&quot;;else print &quot;unstranded&quot;}' &gt; ${OUT_DIR}/test.libtype
</code></pre>

<ul>
<li><a href="https://combine-lab.github.io/salmon/getting_started/" target="_blank">Salmon</a></li>
</ul>

<p>This tool will automatically detect the strandness of the library.</p>

<pre><code>salmon quant -i &lt;transcriptome index&gt; --libType A \
             -o &lt;out dir and prefix&gt; -1 test_1.fq.gz -2 test_2.fq.gz
             -p &lt;assigned threads&gt;
</code></pre>

<p>The <code>--libType A</code> option will allow Salmon to automatically infer the library type. Check the running log for the strand information.</p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev"></span>
  <span class="nav-next"><a href="/en/2017/08/solar-eclipse/">Solar Eclipse</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
  } else if (e.which == 39) {  
    
    url = '\/en\/2017\/08\/solar-eclipse\/';
    
  }
  if (url) window.location = url;
});
</script>



<section class="comments">
  <div id="disqus_thread"></div>
  <script src="/js/disqusloader.min.js"></script>
  <script>
  var disqus_config = function () {
  
    this.page.url = "https:\/\/littlebitofdata.com\/" + location.pathname;
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//https-littlebitofdata-com.disqus.com/embed.js';
    
    if (location.hash.match(/^#comment/)) {
      var d = document, s = d.createElement('script');
      s.src = disqus_js; s.async = true;
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    } else {
      disqusLoader('#disqus_thread', {
        scriptUrl: disqus_js, laziness: 0, disqusConfig: disqus_config
      });
    }
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




<script async src="/js/center-img.js"></script>

<script async src="/js/right-quote.js"></script>

<script async src="/js/no-highlight.js"></script>

<script async src="/js/fix-footnote.js"></script>

<script async src="/js/math-code.js"></script>


<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; <a href="/">Hong Zheng</a> 2017 - 2021 | <a href="https://github.com/zhengh42">GitHub</a></div>
  
  </footer>
  </article>
  
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-104890341-1', 'auto');
ga('send', 'pageview');
</script>

  </body>
</html>

