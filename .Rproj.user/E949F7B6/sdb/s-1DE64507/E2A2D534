{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Strandness in RNASeq\"\ndate: '2017-08-17'\nslug: Strandness_in_RNASeq\n---\n\nHow to tell whether the paired-end sequencing reads in an RNASeq library are strand-specific or not? According to how read 1 and read 2 align to DNA and RNA sequences, there are three types of RNASeq libraries:\n\n<img src=\"https://github.com/zhengh42/myfiles/blob/master/sequencing/RNASeq_strandness.png?raw=true\" width=\"480\" height=\"280\" />\n\n- If sequences of read 1 align to the RNA strand, the library is \"stranded\".\n- If sequences of read 2 align to the RNA strand, the library is \"reversed stranded\".\n- Sometimes sequences of read 1 align to the RNA strand; the other times sequences of read 2 align to the RNA strand. The library is \"unstranded\".\n\nDifferent tools have different names for stranded setting. To name a few:\n\n\n|\t            |Condition A\t| Condition B\t| Condition C |\n| ---         | ---         | ---         | ---         |\n|METHODS/KITS\t|Ligation, Standard SOLiD         |\tdUTP, IlluminaTruSeq Stranded |\tStandard Illumina             |\n|TopHat\t      |--library-type fr-secondstrand\t  | --library-type fr-firststrand\t| --library-type fr-unstranded  |\n|HTSeq\t      |stranded=yes                     |\tstranded=reverse              |\tstranded=no                   |\n|FeatureCounts|-s 1                             |\t-s 2                          |\t-s 0                          |\n|RSEM\t        |--forward-prob 1                 |\t--forward-prob 0              |\t--forward-prob 0.5            |\n|Kallisto     |\t--fr-stranded\t                  | --rf-stranded                 | \t                            |\n|Salmon       |\t-l ISF                          |\t-l ISR                        |\t-l IU                         |\n|collectRnaSeqMetrics |\tFIRST\\_READ\\_TRANSCRIPTION\\_STRAND |\tSECOND\\_READ\\_TRANSCRIPTION\\_STRAND\t|              |\n|Trinity\t    |   --SS\\_lib\\_type FR            |\t--SS\\_lib\\_type RF\t          |                               |\n\n\nWhat is the most convenient way to tell the strandness? Usually I take several thousands reads from both read 1 and read 2, naming it as test\\_1.fg.gz and test\\_2.fq.gz, and run one of the following tools:\n\n\n- <a href=\"https://github.com/alexdobin/STAR\" target=\"_blank\">STAR</a>\n\n```\nSTAR --genomeDir <reference index directory> --runThreadN <assigned threads> \\\n      --readFilesIn test_1.fq.gz test_2.fq.gz --readFilesCommand zcat \\\n      --outFileNamePrefix <out dir and prefix> --outSAMtype BAM  SortedByCoordinate \\\n      --twopassMode Basic --sjdbOverhang <readlength - 1 > \\\n      --quantMode TranscriptomeSAM GeneCounts \\\n      --outSAMunmapped Within  --outFilterType BySJout  --outSAMattributes NH HI AS NM MD\n```\n\nThe `--quantMode GeneCounts` option will output a file with suffix \"ReadsPerGene.out.tab\", which counts the number of reads mapping to each gene. For example:\n\n```\nENSG00000198804.2       555285  290702  281079\nENSG00000198938.2       471151  238612  232541\nENSG00000198886.2       466966  236203  230767\nENSG00000210082.2       404889  203289  201602\nENSG00000198712.1       359278  175022  184256\nENSG00000198727.2       297601  150393  147574\nENSG00000198763.3       288383  149779  138612\nENSG00000156508.17      189858  96202   93663\n```\n\n2rd column: counts for unstranded RNASeq (condition C)  \n3rd column: counts for the stranded RNASeq (condition A)  \n4rd column: counts for the reverse stranded RNASeq (condition B)  \n\nIn the case above, the library is unstranded. If 4rd column counts are almost zero, the library is stranded, and vice versa.\n\n\n\n- <a href=\"https://combine-lab.github.io/salmon/getting_started/\" target=\"_blank\">Salmon</a>\n\nThis tool will automatically detect the strandness of the library.\n\n```\nsalmon quant -i <transcriptome index> --libType A \\\n             -o <out dir and prefix> -1 test_1.fq.gz -2 test_2.fq.gz \n             -p <assigned threads>\n```\n\nThe `--libType A` option will allow Salmon to automatically infer the library type. Check the running log for the strand information. ",
    "created" : 1502955640874.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3507387806",
    "id" : "E2A2D534",
    "lastKnownWriteTime" : 1503038403,
    "last_content_update" : 1503038403912,
    "path" : "~/Google Drive/GitHub/hong_pages/content/en/2017-08-17-rnaseq-strandness.md",
    "project_path" : "content/en/2017-08-17-rnaseq-strandness.md",
    "properties" : {
        "ignored_words" : "Strandness,RNASeq,img,src,https,github,zhengh,myfiles,strandness,png,unstranded,SOLiD,dUTP,IlluminaTruSeq,Illumina,TopHat,secondstrand,firststrand,HTSeq,FeatureCounts,Kallisto,rf,collectRnaSeqMetrics,fg,gz,fq,ReadsPerGene,versa\n"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "markdown"
}